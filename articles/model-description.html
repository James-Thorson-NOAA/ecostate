<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ecostate model description • ecostate</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ecostate model description">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecostate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/too_slow/age_structured_interactions.html">Age-structured and bottom-up interactions</a></li>
    <li><a class="dropdown-item" href="../articles/model-description.html">ecostate model description</a></li>
    <li><a class="dropdown-item" href="../articles/model_of_intermediate_complexity.html">Model of Intermediate Complexity</a></li>
    <li><a class="dropdown-item" href="../articles/not_on_cran/simulation.html">Demonstrating EcoState via simulation</a></li>
    <li><a class="dropdown-item" href="../articles/not_on_cran/surplus_production.html">EcoState as surplus production model</a></li>
    <li><a class="dropdown-item" href="../articles/too_slow/whole_of_ecosystem.html">Whole of ecosystem model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/James-Thorson-NOAA/ecostate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ecostate model description</h1>
                        <h4 data-toc-skip class="author">James T.
Thorson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/James-Thorson-NOAA/ecostate/blob/HEAD/vignettes/model-description.Rmd" class="external-link"><code>vignettes/model-description.Rmd</code></a></small>
      <div class="d-none name"><code>model-description.Rmd</code></div>
    </div>

    
    
<!-- math bold nonitalic -->
<!-- math nonitalic -->
<div class="section level2">
<h2 id="introducing-ecostate">Introducing ecostate<a class="anchor" aria-label="anchor" href="#introducing-ecostate"></a>
</h2>
<p><code>ecostate</code> <span class="citation">(Thorson et al.
2025)</span> is an R package that implements a nonlinear state-space
model representing equilibrium conditions from Ecopath <span class="citation">(Polovina 1984)</span>, biomass dynamics from Ecosim
<span class="citation">(Walters, Christensen, and Pauly 1997)</span>,
and age/stage-structured dynamics from Ecosim version-2 <span class="citation">(Walters et al. 2000)</span>. The parameterization is
heavily inspired by RPath <span class="citation">(Lucey, Gaichas, and
Aydin 2020)</span>. However, it also adds features that are not
available in EwE or Rpath including:</p>
<ul>
<li><p><em>Estimating equilibrium and dynamical parameters
simultaneously</em>: ecostate uses maximum likelihood estimation to
identify the values (and standard errors) for parameters representing
both ecosystem equilibrium (e.g., equilibrium biomass,
production/consumption per biomass), ecosystem dynamics (e.g., ratio of
initial to equilibrium biomass), and measurement parameters (e.g.,
catchability coefficient);</p></li>
<li><p><em>Process errors</em>: ecostate can estimate errors in both
biomass index and catch measurements, as well as unexplained variation
in dynamics (termed “process errors”). It then estimates the variance of
process errors using hierarchical modelling techniques;</p></li>
<li><p><em>Priors and likelihood penalties</em>: ecostate allows the
user to specify a Bayesian prior or likelihood penalty on parameters,
rather than fixing them a priori.</p></li>
</ul>
<p>These features ensure that anyone running <em>ecostate</em> can
rapidly update the model using new data or ecosystem assumptions.
Results can then be exactly reproduced, allowing model performance to be
explored via simulation modelling.</p>
</div>
<div class="section level2">
<h2 id="state-space-mass-balance-modelling">State-space mass balance modelling<a class="anchor" aria-label="anchor" href="#state-space-mass-balance-modelling"></a>
</h2>
<p>The model starts by defining equilibrium biomass
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>s</mi></msub><annotation encoding="application/x-tex">\bar{\beta}_s</annotation></semantics></math>
for each taxon
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>S</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">s \in \{1,2,...,S\}</annotation></semantics></math>,
and using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
to refer to taxa when they are prey or predator. Every taxon is defined
as a heterotroph (consumer), autotroph (producer), or detritus pool,
which affects dynamics as explained later. This equilibrium depends upon
prey production per biomass
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">p_i</annotation></semantics></math>,
the proportion of prey production that is explained in the model (termed
“ecotrophic efficiency”)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>i</mi></msub><annotation encoding="application/x-tex">e_i</annotation></semantics></math>,
diet proportion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">d_{i,j}</annotation></semantics></math>
for each predator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
and prey
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and predator consumption per biomass
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>j</mi></msub><annotation encoding="application/x-tex">w_j</annotation></semantics></math>:</p>
<p><span class="math display">$$
\underbrace{\bar{\beta}_i}_{\text{Equilibrium biomass as prey}}
\times \underbrace{p_i}_{\text{Prey production per biomass}}
\times \underbrace{e_i}_{\text{Ecotrophic efficiency}} = \\
\sum_{j=1}^S{\left(
  \underbrace{d_{i,j}}_{\text{Proportion of diet for predator }j \text{
by prey }i}
  \times \underbrace{\bar{\beta}_j}_{\text{Equilibrium biomass for
predator }j}
  \times \underbrace{w_j}_{\text{Predator consumption per biomass}}
\right)}
$$</span> Autotroph and detritus taxa
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
have no consumption so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">d_{i,j}</annotation></semantics></math>
for these taxa. We can then solve for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>×</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">S \times S</annotation></semantics></math>
matrix of equilibrium consumption
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝐂</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{\mathbf{C}}</annotation></semantics></math>
as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝐂</mi><mo accent="true">‾</mo></mover><mo>=</mo><msup><mrow><mi>𝐃</mi><mo mathvariant="bold">⊙</mo><mo stretchy="false" form="prefix" mathvariant="bold">(</mo><mn>𝟏</mn><mrow><mo stretchy="true" form="prefix" mathvariant="bold">(</mo><mover><mi>𝛃</mi><mo accent="true">‾</mo></mover><mo mathvariant="bold">⊙</mo><mi>𝐰</mi><mo stretchy="true" form="postfix" mathvariant="bold">)</mo></mrow></mrow><mi>T</mi></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
\bar{\mathbf{C}} = \mathbf{D \odot ( 1 (\bar{\beta} \odot w)}^T ) 
</annotation></semantics></math></p>
<p>Given these equilibrium values, we then define a differential
equation for biomass dynamics which we integrate over time to calculate
biomass at times
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>T</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">t \in \{ 1, 2, ..., T \}</annotation></semantics></math>.
In parallel, we also integrate catches
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta_s(t)</annotation></semantics></math>
over time, while resetting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\eta_s(t)=0</annotation></semantics></math>
at the beginning of each time-interval and recording the integrated
catch at the end of each interval:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mtext mathvariant="normal">d</mtext><mrow><mtext mathvariant="normal">d</mtext><mi>t</mi></mrow></mfrac><mi>𝛃</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><munder><munder><mrow><mi>𝐠</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Growth rate</mtext></munder><mo>−</mo><munder><munder><mrow><mi>𝐦</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Natural mortality rate</mtext></munder><mo>−</mo><munder><munder><mrow><mi>𝐟</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Fishing mortality rate</mtext></munder><mo>+</mo><munder><munder><mrow><mi>𝛜</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Process error</mtext></munder><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>⊙</mo><mi>𝛃</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mtext mathvariant="normal">d</mtext><mrow><mtext mathvariant="normal">d</mtext><mi>t</mi></mrow></mfrac><mi>𝛈</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>𝐟</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>⊙</mo><mi>𝛃</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{gather}
\frac{\text{d}}{\text{d}t} \mathbf{\beta}(t) = &amp;  
\left(
  \underbrace{\mathbf{g}(t)}_{\text{Growth rate}} - 
  \underbrace{\mathbf{m}(t)}_{\text{Natural mortality rate}} - 
  \underbrace{\mathbf{f}(t)}_{\text{Fishing mortality rate}} + 
  \underbrace{\mathbf{\epsilon}(t)}_{\text{Process error}}  
\right) 
&amp; \odot \mathbf{\beta}(t) \\
\frac{\text{d}}{\text{d}t} \mathbf{\eta}(t) = &amp; \mathbf{f}(t) &amp; \odot \mathbf{\beta}(t)
\end{gather}
</annotation></semantics></math></p>
<p>where biomass growth rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_s(t)</annotation></semantics></math>
and natural mortality rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">m_s(t)</annotation></semantics></math>
are calculated from predicted consumption
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐂</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{C}(t)</annotation></semantics></math>
representing the mass
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c_{i,j}(t)</annotation></semantics></math>
of prey
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
consumed by predator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
and fishing mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f_s(t)</annotation></semantics></math>
is an estimated parameter that is informed by catch data.</p>
<p>Consumption
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c_{i,j}(t)</annotation></semantics></math>
varies around the equilibrium consumption:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><munder><mrow><msub><mover><mi>c</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">equilibrium consumption rate</mtext></munder><mo>×</mo><munder><munder><mfrac><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mfrac><mrow><msub><mi>β</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>j</mi></msub></mfrac></mrow><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>−</mo><mn>1</mn><mo>+</mo><mfrac><mrow><msub><mi>β</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>j</mi></msub></mfrac></mrow></mfrac><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">predator functional response</mtext></munder><mo>×</mo><munder><munder><mfrac><mrow><msub><mi>β</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>i</mi></msub></mfrac><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">prey functional response</mtext></munder></mrow><annotation encoding="application/x-tex">
c_{i,j}(t) = \underbrace{\bar{c}_{i,j}(t)}_{\text{equilibrium consumption rate}} \times
\underbrace{\frac{x_{i,j}\frac{\beta_j(t)}{\bar{\beta}_j}}{x_{i,j} - 1 + \frac{\beta_j(t)}{\bar{\beta}_j}}}_{\text{predator functional response}} \times
\underbrace{\frac{\beta_i(t)}{\bar{\beta}_i}}_{\text{prey functional response}}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>
is the matrix of predator-prey vulnerability parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">x_{i,j}</annotation></semantics></math>.</p>
<p>Natural mortality is then calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><munder><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>c</mi><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>β</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Predation rate</mtext></munder><mo>+</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><munder><munder><mrow><msub><mi>p</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>e</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Residual natural mortality rate</mtext></munder></mtd><mtd columnalign="left" style="text-align: left"><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> if </mtext><mspace width="0.333em"></mspace></mrow><mi>s</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is autotroph or heterotroph</mtext></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><munder><munder><msub><mi>ν</mi><mi>s</mi></msub><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Detritus loss rate</mtext></munder></mtd><mtd columnalign="left" style="text-align: left"><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> if </mtext><mspace width="0.333em"></mspace></mrow><mi>s</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is detritus</mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
m_s(t) = \underbrace{\frac{\sum_{j=1}^S c_{s,j}(t)}{\beta_s(t)}}_{\text{Predation rate}} + 
\begin{cases}
  \underbrace{p_s(1-e_s)}_{\text{Residual natural mortality rate}} &amp; \text{ if } s \text{ is autotroph or heterotroph} \\
  \underbrace{\nu_s}_{\text{Detritus loss rate}} &amp; {\text{ if } s \text{ is detritus}}
\end{cases}
</annotation></semantics></math> where residual natural mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>e</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_s(1-e_s)</annotation></semantics></math>
accounts for predation by unmodeled taxa, senescence and disease.</p>
<p>The residual mortality rate is defined differently for detritus than
other taxa, and this detritus loss rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ν</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\nu_s</annotation></semantics></math>
is defined to ensure that net detritus accumulation matches net
consumption plus export at equilibrium:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><munder><mrow><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>s</mi></msub><msub><mi>ν</mi><mi>s</mi></msub></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Equil. detritus loss</mtext></munder><mo>=</mo><munder><munder><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>μ</mi><mi>j</mi></msub><msub><mover><mi>c</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>j</mi></msub><msub><mi>p</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>e</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Equil. detritus accumulation</mtext></munder><mo>−</mo><munder><munder><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mover><mi>c</mi><mo accent="true">‾</mo></mover><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Equil. detritus consumption</mtext></munder></mrow><annotation encoding="application/x-tex">
\underbrace{\bar{\beta}_s \nu_s}_{\text{Equil. detritus loss}} = \underbrace{\sum_{i=1}^S \sum_{j=1}^S \mu_j \bar{c}_{i,j} + \sum_{j=1}^S \bar{\beta}_j p_s (1-e_s)}_{\text{Equil. detritus accumulation}} - \underbrace{\sum_{j=1}^S \bar{c}_{s,j}}_{\text{Equil. detritus consumption}}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\mu_j</annotation></semantics></math>
is the proportion of consumption that is not assimilated for predator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></msubsup><msub><mi>μ</mi><mi>j</mi></msub><msub><mover><mi>c</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sum_{i=1}^S \sum_{j=1}^S \mu_j \bar{c}_{i,j}</annotation></semantics></math>
flows to detritus via unassimilated consumption. Similarly,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>e</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_j(1-e_j)</annotation></semantics></math>
is unexplained mortality which we assume flows to consumption with total
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></msubsup><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>j</mi></msub><msub><mi>p</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>e</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_{j=1}^S \bar{\beta}_j p_s (1-e_s)</annotation></semantics></math>.</p>
<p>Biomass growth rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_s(t)</annotation></semantics></math>
is also calculated from consumption:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac><msub><mi>p</mi><mi>s</mi></msub><msub><mi>w</mi><mi>s</mi></msub></mfrac><mo>×</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>c</mi><mrow><mi>i</mi><mo>,</mo><mi>s</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>β</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> if </mtext><mspace width="0.333em"></mspace></mrow><mi>s</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is heterotroph</mtext></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mrow><msub><mi>p</mi><mi>s</mi></msub><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>s</mi></msub></mrow><mrow><msub><mi>β</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>×</mo><mfrac><mrow><msub><mi>x</mi><mrow><mi>s</mi><mo>,</mo><mi>s</mi></mrow></msub><mfrac><mrow><msub><mi>β</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>s</mi></msub></mfrac></mrow><mrow><msub><mi>x</mi><mrow><mi>s</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>−</mo><mn>1</mn><mo>+</mo><mfrac><mrow><msub><mi>β</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mover><mi>β</mi><mo accent="true">‾</mo></mover><mi>s</mi></msub></mfrac></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> if </mtext><mspace width="0.333em"></mspace></mrow><mi>x</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is autotroph</mtext></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>μ</mi><mi>j</mi></msub><msub><mi>c</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>β</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>p</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>e</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>β</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> if </mtext><mspace width="0.333em"></mspace></mrow><mi>s</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is detritus</mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
g_s(t) = \begin{cases}
\frac{p_s}{w_s} \times \frac{\sum_{i=1}^S c_{i,s}(t)}{\beta_s(t)} &amp; \text{ if } s \text{ is heterotroph} \\
\frac{p_s \bar{\beta}_s}{\beta_s(t)} \times \frac{x_{s,s}\frac{\beta_s(t)}{\bar{\beta}_s}}{x_{s,s} - 1 + \frac{\beta_s(t)}{\bar{\beta}_s}} &amp; \text{ if } x \text{ is autotroph} \\
\frac{\sum_{i=1}^S \sum_{j=1}^S \mu_j c_{i,j}(t) + \sum_{j=1}^S \beta_j(t)p_j(1-e_j)}{\beta_s(t)} &amp; \text{ if } s \text{ is detritus} 
\end{cases}
</annotation></semantics></math> This expression states that:</p>
<ul>
<li><p><em>Heterotrophs</em>: The growth rate for heterotrophs is
consumption per biomass times the ratio of production and consumption
per biomass;</p></li>
<li><p><em>Autotrophs</em>: The autotroph growth rate is calculated so
that production is constant but adjusted by a Type-2 functional response
using vulnerability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>s</mi><mo>,</mo><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">x_{s,s}</annotation></semantics></math>;</p></li>
<li><p><em>Detritus</em>: The detritus growth rate is total detritus
gain per detritus biomass.</p></li>
</ul>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-lucey_conducting_2020" class="csl-entry">
Lucey, Sean M., Sarah K. Gaichas, and Kerim Y. Aydin. 2020.
<span>“Conducting Reproducible Ecosystem Modeling Using the Open Source
Mass Balance Model <span>Rpath</span>.”</span> <em>Ecological
Modelling</em> 427 (July): 109057. <a href="https://doi.org/10.1016/j.ecolmodel.2020.109057" class="external-link">https://doi.org/10.1016/j.ecolmodel.2020.109057</a>.
</div>
<div id="ref-polovina_model_1984" class="csl-entry">
Polovina, Jeffrey J. 1984. <span>“Model of a Coral Reef
Ecosystem.”</span> <em>Coral Reefs</em> 3 (1): 1–11. <a href="https://doi.org/10.1007/BF00306135" class="external-link">https://doi.org/10.1007/BF00306135</a>.
</div>
<div id="ref-thorson_benefits_2025" class="csl-entry">
Thorson, James T., Kasper Kristensen, Kerim Y. Aydin, Sarah K. Gaichas,
David G. Kimmel, Elizabeth A. McHuron, Jens M. Nielsen, Howard Townsend,
and George A. Whitehouse. 2025. <span>“The <span>Benefits</span> of
<span>Hierarchical</span> <span>Ecosystem</span> <span>Models</span>:
<span>Demonstration</span> <span>Using</span> <span>EcoState</span>, a
<span>New</span> <span>State</span>-<span>Space</span>
<span>Mass</span>-<span>Balance</span> <span>Model</span>.”</span>
<em>Fish and Fisheries</em> 26 (2): 203–18. <a href="https://doi.org/10.1111/faf.12874" class="external-link">https://doi.org/10.1111/faf.12874</a>.
</div>
<div id="ref-walters_structuring_1997" class="csl-entry">
Walters, Carl, Villy Christensen, and Daniel Pauly. 1997.
<span>“Structuring Dynamic Models of Exploited Ecosystems from Trophic
Mass-Balance Assessments.”</span> <em>Reviews in Fish Biology and
Fisheries</em> 7 (2): 139–72. <a href="https://doi.org/10.1023/A:1018479526149" class="external-link">https://doi.org/10.1023/A:1018479526149</a>.
</div>
<div id="ref-walters_representing_2000" class="csl-entry">
Walters, Carl, Daniel Pauly, Villy Christensen, and James F. Kitchell.
2000. <span>“Representing <span>Density</span> <span>Dependent</span>
<span>Consequences</span> of <span>Life</span> <span>History</span>
<span>Strategies</span> in <span>Aquatic</span> <span>Ecosystems</span>:
<span>EcoSim</span> <span>II</span>.”</span> <em>Ecosystems</em> 3 (1):
70–83. <a href="https://doi.org/10.1007/s100210000011" class="external-link">https://doi.org/10.1007/s100210000011</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James T. Thorson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
